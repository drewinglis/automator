// Generated by CoffeeScript 1.6.3
var Automator;

Automator = (function() {
  Automator.prototype.options = {
    namespace: "automator"
  };

  function Automator(datastore, options) {
    if (options == null) {
      options = {};
    }
    $.extend(this.options, options);
    this.datastore = datastore;
    this.categories = datastore.getTable("" + this.options.namespace + "-categories");
    this.words = datastore.getTable("" + this.options.namespace + "-words");
  }

  Automator.prototype.train = function(text, category) {
    var words;
    category = category.toLowerCase();
    words = text.toLowerCase().split(" ");
    this._increment(this.categories, category);
    _.map(words, function(word) {
      var categoryCount, record;
      record = this._increment(this.words, word);
      categoryCount = (record.get(category)) || 0;
      return record.set(category, categoryCount + 1);
    });
  };

  Automator.prototype.classify = function(text) {
    return {
      classification: {
        category: "unknown",
        reason: [],
        confidence: 0
      }
    };
  };

  Automator.prototype._increment = function(table, name) {
    var count, record, records;
    records = table.query({
      NAME: name
    });
    record = records[0];
    if (records.length < 1) {
      record = table.insert({
        NAME: name,
        COUNT: 0
      });
    }
    count = record.get("COUNT");
    record.set('COUNT', count + 1);
    return record;
  };

  return Automator;

})();
